<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  <title>Volumetric Sequence Player</title>
  <link type="text/css" rel="stylesheet" href="main.css">
  <style>
    .label {
      color: #FFF;
      font-family: sans-serif;
      padding: 2px;
      background: rgba(0, 0, 0, .6);
    }
  </style>
</head>

<body>
<div id="info">Sequence Player - three-volumetric</div>


<script src="https://unpkg.com/three@0.117.1/build/three.js"></script>
<script src="https://unpkg.com/three@0.117.1/examples/js/geometries/TeapotBufferGeometry.js"></script>
<script src="https://unpkg.com/three@0.117.1/examples/js/controls/OrbitControls.js"></script>
<script src="../dist/three-volumetric.js"></script>
<script>
  var camera, scene, renderer, controls

  init()
  animate()

  function init() {
    scene = new THREE.Scene()

    renderer = new THREE.WebGLRenderer({ antialias: true })
    renderer.setPixelRatio(window.devicePixelRatio)
    renderer.setSize(window.innerWidth, window.innerHeight)
    document.body.appendChild(renderer.domElement)

    camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000)
    camera.position.set(200, 100, 0)

    // controls
    controls = new THREE.OrbitControls(camera, renderer.domElement)

    const teapotMesh = new THREE.Mesh(
      new THREE.TeapotBufferGeometry(40),
      new THREE.MeshNormalMaterial()
    )
    teapotMesh.position.y = 10
    //scene.add(teapotMesh)

    const axesHelper = new THREE.AxesHelper(50)
    scene.add(axesHelper)

    // lights

    var light = new THREE.DirectionalLight(0xffffff)
    light.position.set(1, 1, 1)
    scene.add(light)

    var light = new THREE.DirectionalLight(0x002288)
    light.position.set(-1, -1, -1)
    scene.add(light)

    var light = new THREE.AmbientLight(0x222222)
    scene.add(light)


    const playerContainer = new THREE.Group()
    playerContainer.rotation.x = -Math.PI / 2
    scene.add(playerContainer)

    // volumetric player
    const player = new GLTFPlayer(
      playerContainer, // scene: any,
      'optimized_howie_v2.glb', // file: string,
      () => { console.log('Player loaded') }, // onLoaded: any,
      30, // startScale: number = 1,
      { x: 0, y: 0, z: 0 }, // startPosition: { x: any; y: any; z: any } = { x: 0, y: 0, z: 0 },
      true, // castShadow: boolean = true,
      true, // playOnStart: boolean = true,
      true, // showFirstFrameOnStart: boolean = true,
      true, // loop: boolean = true,
      2, // startFrame: number = 0,
      // endFrame: number = -1,
      // frameRate: number = 60,
      // speedMultiplier: number = 1
    )

    //

    window.addEventListener('resize', onWindowResize, false)
  }

  function onWindowResize() {

    camera.aspect = window.innerWidth / window.innerHeight
    camera.updateProjectionMatrix()

    renderer.setSize(window.innerWidth, window.innerHeight)

  }

  function animate() {
    requestAnimationFrame(animate)

    renderer.render(scene, camera)
  }

</script>

</body>

</html>
